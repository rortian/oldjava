<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title> </title>
</head>
<body BGCOLOR=#eeeeff text=#000000 LINK=#0000ff VLINK=#000077 ALINK=#ff0000>
 
<table width=600><tr>
<td><a href="innerclasses.doc.html">Contents</a> | <a href="innerclasses.doc12.html">Prev</a> | Next </td><td align=right><i>Inner Classes Specification</i></td>
</tr></table>

<hr><br>
 
<a name="15329"></a>
<h1> Further Example:  Multi-threaded task partitioning.
</h1>
<a name="15341"></a>
It is sometimes useful to parallelize a task with independent sub-tasks, by 
assigning each sub-task to a thread.  This can make the whole task finish 
sooner, if multiple processors are involved.  (This will be the case, if the sub-
tasks perform network traffic.)  In interactive Java programs, multithreading is 
also used to enable partial results from sub-tasks to be pushed through to the 
end user, while slower sub-tasks continue to grind away.
<p><a name="16892"></a>
The code below (based on an example from Doug Lea) shows a very simple 
way to control the rendering of several pictures in such a way that each picture 
is delivered to a displayer as soon as it's ready, but the original requester 
blocks until all rendering is finished.  Each sub-task is coded by an anonymous 
implementation of <code>Runnable</code> which is at the heart of each thread. 
<Table Border="0">
<caption></caption>
<tr><td><br><pre>    <a name="16895"></a>public class GroupPictureRenderer {
    <a name="16896"></a>  private PictureRenderer renderer;
    <a name="16897"></a>  private PictureDisplayer displayer;
    <a name="16898"></a>  ...
    <a name="16899"></a>
    <a name="16900"></a>  public Picture[] render(final byte[][] rawPictures)
    <a name="16901"></a>                    throws InterruptedException {
    <a name="16902"></a>    Thread workers[] = new Thread[rawPictures.length];
    <a name="16903"></a>    final Picture results[] = new Picture[rawPictures.length];
    <a name="16904"></a>    // start one thread per rendering sub-task
    <a name="16905"></a>    for (int ii = 0; ii &lt; rawPictures.length; ii++) {
    <a name="16906"></a>      final int i = ii;   // capture ii for each new thread
    <a name="16907"></a>      Runnable work = new Runnable() {
    <a name="16908"></a>            public void run() {
    <a name="16909"></a>              results[i] = renderer.render(rawPictures[i]);
    <a name="16910"></a>              displayer.display(results[i]);
    <a name="16911"></a>            }
    <a name="16912"></a>      };
    <a name="16913"></a>      workers[i] = new Thread(work, "Renderer");
    <a name="16914"></a>      workers[i].start();
    <a name="16915"></a>    }
    <a name="16916"></a>    // all threads are running; now wait for them all to finish
    <a name="16917"></a>    for (int i = 0; i &lt; workers.length; i++)
    <a name="16918"></a>      workers[i].join();
    <a name="16919"></a>    // give all the finished pictures to the caller, too:
    <a name="16920"></a>    return results;
    <a name="16921"></a>  }
    <a name="16922"></a>}
</pre>

</Table>

<!--
<Table>
<tr><td>
</Table>
-->
<p>

<hr>
<!-- This inserts footnotes--><p>
<a href="innerclasses.doc.html">Contents</a> | <a href="innerclasses.doc12.html">Prev</a> | Next 
<p>
<font size=-1>Inner Classes Specification (HTML generated by dkramer on March 15, 1997)<br>
<i><a href="copyright.doc.html">Copyright &#169 1996, 1997 Sun Microsystems, Inc.</a>
All rights reserved</i>
<br>
Please send any comments or corrections to <a href="mailto:john.rose@eng.sun.com">john.rose@eng.sun.com</a>
</font>
</body></html>