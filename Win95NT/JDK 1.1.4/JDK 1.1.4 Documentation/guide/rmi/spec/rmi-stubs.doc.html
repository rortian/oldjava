<html><head><title>Stub/Skeleton Interfaces
</title></head>
<body bgcolor=#ffffff>
 
<a href="rmiTOC.doc.html">[TOC]</a> <a href="rmi-registry.doc.html">[Prev]</a> <a href="rmi-dgc.doc.html">[Next]</a>
<hr><br>
 
<a name="60">
<h1>Stub/Skeleton Interfaces
</h1>
</a>
<hr><p><a name="64">

<p>
</a>This section contains the interfaces and classes used by the stubs and skeletons 
generated by the <code>rmic</code> stub compiler.
<p><h3><a name="3210">
Topics:
</a></h3><ul><li><a href="rmi-stubs.doc.html#4526">The RemoteStub Class</a>
<li><a href="rmi-stubs.doc.html#161">The RemoteCall Interface</a>
<li><a href="rmi-stubs.doc.html#5474">The RemoteRef Interface</a>
<li><a href="rmi-stubs.doc.html#6689">The ServerRef Interface</a>
<li><a href="rmi-stubs.doc.html#5718">The Skeleton Interface</a>
<li><a href="rmi-stubs.doc.html#6598">The Operation Class</a>
</ul><h1><a name="4526">
The RemoteStub Class
</a></h1>The <code>java.rmi.server.RemoteStub</code> class is the common superclass to all 
client stubs. Stub objects are surrogates that support exactly the same set of 
remote interfaces defined by the actual implementation of a remote object.
<p><dl><a name="4543"><pre>package java.rmi.server;
</pre></a><a name="4540"><pre>public abstract class RemoteStub extends java.rmi.RemoteObject {}
</pre></a></dl><h1><a name="161">
The RemoteCall Interface
</a></h1>The interface <code>RemoteCall</code> is an abstraction used by the stubs and skeletons of 
remote objects to carry out a call to a remote object.
<p><dl><a name="6486"><pre>package java.rmi.server;
import java.io.*;

public interface RemoteCall {

	ObjectOutput getOutputStream() throws IOException;

	void releaseOutputStream() throws IOException;

	ObjectInput getInputStream() throws IOException;

	void releaseInputStream() throws IOException;

	ObjectOutput getResultStream(boolean success)
		throws IOException, StreamCorruptedException;

	void executeCall() throws Exception;

	void done() throws IOException;
}
</pre></a></dl>The method <code>getOutputStream</code> returns the output stream into which either 
the stub marshals arguments or the skeleton marshals results.
<p>The method <code>releaseOutputStream</code> releases the output stream; in some 
transports this will release the stream.
<p>The method <code>getInputStream</code> returns the InputStream from which the stub 
unmarshals results or the skeleton unmarshals parameters.
<p>The method <code>releaseInputStream</code> releases the input stream. This will allow 
some transports to release the input side of a connection early.
<p>The method <code>getResultStream</code> returns an output stream (after writing out 
header information relating to the success of the call). Obtaining a result 
stream should only succeed once per remote call. If success is true, then the 
result to be marshaled is a normal return; otherwise the result is an exception. 
<code>StreamCorruptedException</code> is thrown if the result stream has already been 
obtained for this remote call.
<p>The method <code>executeCall</code> does whatever it takes to execute the call.
<p>The method <code>done</code> allows cleanup after the remote call has completed.
<p><h1><a name="5474">
The RemoteRef Interface
</a></h1>The interface <code>RemoteRef</code> represents the handle for a remote object. Each stub 
contains an instance of RemoteRef that contains the concrete representation of 
a reference. This remote reference is used to carry out remote calls on the 
remote object for which it is a reference.
<p><dl><a name="5478"><pre>package java.rmi.server;

public interface RemoteRef extends java.io.Externalizable {

	RemoteCall newCall(RemoteObject obj, Operation[] op, int opnum,
		long hash) throws RemoteException;

	void invoke(RemoteCall call) throws Exception;

	void done(RemoteCall call) throws RemoteException;

	String getRefClass(java.io.ObjectOutput out);

	int remoteHashCode();

	boolean remoteEquals(RemoteRef obj);

	String remoteToString();
}

</pre></a></dl>The method <code>newCall</code> creates an appropriate call object for a new remote 
method invocation on the remote object obj. The operation array op contains the 
available operations on the remote object. The operation number, opnum, is an 
index into the operation array which specifies the particular operation for this 
remote call. Passing the operation array and index allows the stubs generator 
to assign the operation indexes and interpret them. The remote reference may 
need the operation description to encode in the call.
<p>The method <code>invoke</code> executes the remote call. <code>invoke</code> will raise any "user" 
exceptions which should pass through and not be caught by the stub. If any 
exception is raised during the remote invocation, <code>invoke</code> should take care of 
cleaning up the connection before raising the "user exception" or 
<code>RemoteException</code>.
<p>The method <code>done</code> allows the remote reference to clean up (or reuse) the 
connection. <code>done</code> should only be called if the <code>invoke</code> call returns successfully 
(non-exceptionally) to the stub.
<p>The method <code>getRefClass</code> returns the nonpackage-qualified class name of the 
reference type to be serialized onto the stream out.
<p>The method <code>remoteHashCode</code> returns a hashcode for a remote object. Two 
remote object stubs that refer to the same remote object will have the same 
hash code (in order to support remote objects as keys in hashtables). A 
<code>RemoteObject</code> forwards a call to its <code>hashCode</code> method to the 
<code>remoteHashCode</code> method of the remote reference.
<p>The method <code>remoteEquals</code> compares two remote objects for equality. Two 
remote objects are equal if they refer to the same remote object. For example, 
two stubs are equal if they refer to the same remote object. A <code>RemoteObject</code> 
forwards a call to its <code>equals</code> method to the <code>remoteEquals</code> method of the 
remote reference. 
<p>The method <code>remoteToString</code> returns a String that represents the reference of 
this remote object.
<p><h1><a name="6689">
The ServerRef Interface
</a></h1>The interface <code>ServerRef</code> represents the server-side handle for a remote object 
implementation.
<p><dl><a name="5722"><pre>package java.rmi.server;

public interface ServerRef extends RemoteRef {

	RemoteStub exportObject(java.rmi.Remote obj, Object data)
		throws java.rmi.RemoteException;

	String getClientHost() throws ServerNotActiveException;
}
</pre></a></dl>The method <code>exportObject</code> finds or creates a client stub object for the 
supplied <code>Remote</code> object implementation obj.The parameter data contains 
information necessary to export the object (such as port number).
<p>The method <code>getClientHost</code> returns the host name of the current client. 
When called from a thread actively handling a remote method invocation, the 
host name of the client invoking the call is returned. If a remote method call is 
not currently being service, then <code>ServerNotActiveException</code> is called.
<p><h1><a name="5718">
The Skeleton Interface
</a></h1>The interface <code>Skeleton</code> is used solely by the implementation of skeletons 
generated by the <code>rmic</code> compiler. A skeleton for a remote object is a server-side 
entity that dispatches calls to the actual remote object implementation.
<p><dl><a name="5798"><pre>package java.rmi.server;

public interface Skeleton {

    void dispatch(Remote obj, RemoteCall call, int opnum, long hash)
		throws Exception;

    Operation[] getOperations();
}
</pre></a></dl>The <code>dispatch</code> method unmarshals any arguments from the input stream 
obtained from the call object, invokes the method (indicated by the operation 
number opnum) on the actual remote object implementation obj, and marshals 
the return value or throws an exception if one occurs during the invocation.
<p>The <code>getOperations</code> method returns an array containing the operation 
descriptors for the remote object's methods.
<p><h1><a name="6598">
The Operation Class
</a></h1>The class <code>Operation</code> holds a description of a Java method for a remote object.
<p><dl><a name="5258"><pre>package java.rmi.server;

public class Operation {

	public Operation(String op);

	public String getOperation();

	public String toString();
}
</pre></a></dl>An <code>Operation</code> object is typically constructed with the method signature.
<p>The method <code>getOperation</code> returns the contents of the operation descriptor 
(the value with which it was initialized).
<p>The method <code>toString</code> also returns the string representation of the operation 
descriptor (typically the method signature).
<p>
<hr><br>
 
<a href="rmiTOC.doc.html">[TOC]</a> <a href="rmi-registry.doc.html">[Prev]</a> <a href="rmi-dgc.doc.html">[Next]</a>
<hr><br>
 


<address>
<a href="mailto:"></a>
</address>

<i>Copyright &#169; 1996, 1997 Sun Microsystems, Inc.  All rights
reserved.</i>

<!-- This file was created with Quadralay WebWorks Publisher 3.0.4 -->
<!-- -->
<!-- For more information on how this document, and how the rest of -->
<!-- this server was created, email  -->
<!-- -->
<!-- Last updated: 03/18/97 13:00:04 -->

</body>
</html>
